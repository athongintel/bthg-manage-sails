div(ng-controller='AdminCustomerController as ctrl' ng-init='ctrl.init()')
    div
        div.row
            div.col-xs-12.col-sm-6
                div.panel-header-title #{__('customer_manage')}
            div.col-xs-12.col-sm-6
                div.text-right
                    button.action.btn.btn-primary.margin-bottom-15px(ng-click='ctrl.addCustomer()')
                        span
                            i.fa.fa-plus
                            span &nbsp;
                        span #{__('add_customer')}

    div.panel.panel-default.main-panel
        div.panel-body
            div
                label #{__('search_customer')}
                select#select_customer.form-control

            div.margin-top-15px
                div.text-center(ng-show='!ctrl.selectedCustomer && !ctrl.loadingCustomerInfo')
                    span #{__('select_a_customer')}

                div.text-center(ng-show='ctrl.loadingCustomerInfo')
                    i.fa.fa-spinner.fa-spin

                div(ng-hide='!ctrl.selectedCustomer || ctrl.loadingCustomerInfo')
                    div.row
                        div.col-xs-6
                            label #{__('customer_info')}
                            span.text-danger.margin-left-15px(ng-show='ctrl.selectedCustomer.customerSaveProblem')
                                i.fa.fa-exclamation-circle
                                span &nbsp;
                                span #{__('save_problem')}
                        div.col-xs-6
                            div.text-right
                                a(href='' ng-click='customerEditForm.$show()')
                                    span #{__('edit_')} &nbsp;
                                    i.fa.fa-pencil
                    form.row-table.margin-bottom-15px(editable-form='' name='customerEditForm' onbeforesave='ctrl.saveCustomer($data)')
                        div.row
                            div.margin-bottom-15px.col-xs-12.col-sm-6
                                label #{__('name_')}
                                div(editable-text="ctrl.selectedCustomer.name" e-name="name" e-required onbeforesave='checkCustomerAttribute("name", $data, ctrl.selectedCustomer.name)') {{ctrl.selectedCustomer.name}}

                            div.margin-bottom-15px.col-xs-12.col-sm-6
                                label #{__('code_')}
                                div(editable-text="ctrl.selectedCustomer.code" e-name="code" e-required onbeforesave='checkCustomerAttribute("code", $data, ctrl.selectedCustomer.code)') {{ctrl.selectedCustomer.code}}
                        div.row
                            div.margin-bottom-15px.col-xs-12.col-sm-6
                                label #{__('phone_number')}
                                div(editable-text="ctrl.selectedCustomer.phoneNumber" e-name="phoneNumber") {{ctrl.selectedCustomer.phoneNumber ||  '#{__("not_set")}'}}

                            div.margin-bottom-15px.col-xs-12.col-sm-6
                                label #{__('fax_number')}
                                div(editable-text="ctrl.selectedCustomer.faxNumber" e-name="faxNumber") {{ctrl.selectedCustomer.faxNumber ||  '#{__("not_set")}'}}

                        div.margin-bottom-15px
                            label #{__('address_')}
                            div(editable-text="ctrl.selectedCustomer.address" e-name="address") {{ctrl.selectedCustomer.address ||  '#{__("not_set")}'}}

                        div.margin-bottom-15px
                            label #{__('company_info')}
                            pre(editable-textarea="ctrl.selectedCustomer.companyInfo" e-name="companyInfo") {{ctrl.selectedCustomer.companyInfo ||  '#{__("not_set")}'}}

                        div.text-right(ng-show='customerEditForm.$visible')
                            button.btn.btn-default(type="button" ng-disabled='customerEditForm.$waiting' ng-click='customerEditForm.$cancel()')
                                span #{__('cancel_')}
                            button.btn.btn-primary.margin-left-15px(type='submit' ng-disabled='customerEditForm.$waiting')
                                span #{__('save_')}

                    label #{__('customer_contact')}
                    div.table-responsive
                        table.table.table-striped.table-hover
                            thead
                                tr
                                    th #{__('name_')}
                                    th #{__('position_')}
                                    th #{__('phone_number')}
                                    th #{__('email_')}
                                    th #{__('discount_')}
                                    td.text-right(style='width: 120px')
                            tbody(style='background: white')
                                tr(ng-show='!ctrl.selectedCustomerContacts || !ctrl.selectedCustomerContacts.length')
                                    td(colspan='6')
                                        div.text-center
                                            span #{__('no_data')}
                                tr(ng-repeat='contact in ctrl.selectedCustomerContacts')
                                    td
                                        div(editable-text="contact.name" e-name="name" e-form="rowform" onbeforesave='ctrl.checkContactAttribute("name", $data, contact)' e-required='') {{contact.name || '#{__("not_set")}'}}
                                    td
                                        div(editable-text="contact.position" e-name="position" e-form="rowform") {{contact.position || '#{__("not_set")}'}}
                                    td
                                        div(editable-text="contact.phoneNumber" e-name="phoneNumber" e-form="rowform") {{contact.phoneNumber || '#{__("not_set")}'}}
                                    td
                                        div(editable-text="contact.email" e-name="email" e-form="rowform") {{contact.email || '#{__("not_set")}'}}
                                    td
                                        div(editable-text="contact.discount" e-name="discount" e-form="rowform") {{contact.discount || '#{__("not_set")}'}}
                                    td.text-right
                                        form.form-buttons.form-inline(editable-form='', name='rowform', onbeforesave='ctrl.updateCustomerContact($data, contact)', ng-show='rowform.$visible', shown='!contact._id')
                                            button.btn.btn-sm.btn-primary.margin-right-5px(type='submit', ng-disabled='rowform.$waiting')
                                                i.fa.fa-floppy-o
                                            button.btn.btn-sm.btn-default(type='button', ng-disabled='rowform.$waiting', ng-click='rowform.$cancel(); ctrl.cancelEditCustomerContact(contact)')
                                                i.fa.fa-ban
                                        .buttons(ng-show='!rowform.$visible')
                                            button.btn.btn-sm.btn-primary.margin-right-5px(type='button', ng-click='rowform.$show()')
                                                i.fa.fa-pencil
                                            button.btn.btn-sm.btn-danger(type='button', ng-click='ctrl.removeCustomerContact(contact, "' + __('remove_customer_contact_prompt') + '")')
                                                i.fa.fa-trash

                        div.text-right
                            button.btn.btn-primary(ng-click='ctrl.addCustomerContact()')
                                span #{__('add_')}


    include ../dialogs/admin-customer-add
